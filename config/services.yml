services:
  _defaults:
    autowire: true
    autoconfigure: true
    public: false

  _instanceof:
    Waffle\Model\Config\ConfigItemInterface:
      tags: ['config_items']
    Waffle\Command\DiscoverableCommandInterface:
      tags: ['commands']
    Waffle\Command\DiscoverableTaskInterface:
      tags: ['tasks']
    Waffle\Command\DiscoverableRecipeInterface:
      tags: ['recipes']

  di_helper:
    public: true
    class: 'Waffle\Helper\DiHelper'
    calls:
        - [ setContainer, [ '@service_container' ]]

  Waffle\:
    resource: '../src'
    lazy: true

  Waffle\Application:
    public: true

  Waffle\Model\IO\IOStyle:
    public: true

  Waffle\Model\Config\ConfigTreeService:
    public: true
    arguments:
      - !tagged config_items

  Waffle\Model\Command\CommandManager:
    public: true
    arguments:
      - !tagged commands

  Waffle\Model\Command\TaskManager:
    public: true
    arguments:
      - '@Waffle\Model\Context\Context'
      - '@Waffle\Model\Command\TaskFactory'
      - !tagged tasks

  Waffle\Model\Command\RecipeManager:
    public: true
    arguments:
      - '@Waffle\Model\Context\Context'
      - '@Waffle\Model\Command\RecipeFactory'
      - !tagged recipes

